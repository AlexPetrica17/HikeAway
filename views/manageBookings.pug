extends base

mixin navItem(link, text, icon, active)
  li(class=`${active ? 'side-nav--active' : ''}`)
    a(href=`${link}`)
      svg
        use(xlink:href=`/img/icons.svg#icon-${icon}`)
      | #{text}

block content
  main.main
    .user-view
      nav.user-view__menu
        ul.side-nav
          +navItem('/me', 'Setări', 'settings')
          +navItem('/my-tours', 'Rezervările mele', 'briefcase')
          +navItem('/my-reviews', 'Recenziile mele', 'star')
          +navItem('/billing', 'Facturare', 'credit-card')
        .admin-nav
          h5.admin-nav__heading Admin
          ul.side-nav
            +navItem('/manage-tours', 'Gestionare tururi', 'map')
            +navItem('/manage-reviews', 'Gestionare recenzii', 'star')
            +navItem('/manage-bookings', 'Gestionare rezervări', 'briefcase', true)
            +navItem('/manage-users', 'Gestionare utilizatori', 'users')

      .user-view__content
        .user-view__form-container

          .tours-table-container
            h2.heading-secondary.ma-bt-md Rezervări existente

            form(method='GET', action='/manage-bookings', class='form-filter', style='margin-bottom: 2rem;')
              .form__group
                label.form__label(for='tourFilter') Tur:
                select#tourFilter.form__input(name='tour')
                  option(value='') Toate tururile
                  if tours
                    each t in tours
                      option(value=t._id selected=(t._id == selectedTour))= t.name
              .form__group
                button.btn.btn--green.btn--small(type='submit') Filtrează

            if bookings.length
              table.table(style='width: 100%; text-align: center; border-collapse: collapse;')
                thead
                  tr(style='background-color: #fff3e0; color: #f97316; font-weight: bold;')
                    th(style='padding: 1rem; border-bottom: 1px solid #f97316;') Tur
                    th(style='padding: 1rem; border-bottom: 1px solid #f97316;') Utilizator
                    th(style='padding: 1rem; border-bottom: 1px solid #f97316;') Email
                    th(style='padding: 1rem; border-bottom: 1px solid #f97316;') Preț
                    th(style='padding: 1rem; border-bottom: 1px solid #f97316;') Acțiune
                tbody
                  each booking in bookings
                    tr(style='border-bottom: 1px solid #eee;')
                      td(style='padding: 1rem;')= booking.tour.name
                      td(style='padding: 1rem;')= booking.user.name
                      td(style='padding: 1rem;')= booking.user.email
                      td(style='padding: 1rem;')= `${booking.price} RON`
                      td(style='padding: 1rem; display: flex; justify-content: center;')
                        button.btn.btn--red.btn--small.delete-booking-btn(type='button', data-id=booking._id)
                          span Șterge
            else
              p(style='padding:2rem;') Nu există rezervări înregistrate.
