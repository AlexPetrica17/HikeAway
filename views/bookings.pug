extends base

mixin navItem(link, text, icon, active)
  li(class=`${active ? 'side-nav--active' : ''}`)
    a(href=`${link}`)
      svg
        use(xlink:href=`img/icons.svg#icon-${icon}`)
      | #{text}

block content
  main.main
    .user-view
      nav.user-view__menu
        ul.side-nav
          +navItem('/me', 'Setări', 'settings')
          +navItem('/my-tours', 'Rezervările mele', 'briefcase', true)
          +navItem('/my-reviews', 'Recenziile mele', 'star')
          +navItem('/billing', 'Facturare', 'credit-card')
        - if (user.role === 'admin')
          .admin-nav
            h5.admin-nav__heading Admin
            ul.side-nav
              +navItem('/manage-tours', 'Gestionare tururi', 'map')
              +navItem('/manage-reviews', 'Gestionare recenzii', 'star')
              +navItem('/manage-bookings', 'Gestionare rezervări', 'briefcase')
              +navItem('/manage-users', 'Gestionare utilizatori', 'users')

      .user-view__content
        .user-view__booking-container
          h2.heading-secondary.ma-bt-md Tururi rezervate:

          .card-container--myTours
            each tour in tours
              .card
                .card__header
                  .card__picture
                    .card__picture-overlay &nbsp;
                    img.card__picture-img(src=`img/tours/${tour.imageCover}`, alt=`${tour.name}`)
                  h3.heading-tertirary
                    span= tour.name

                .card__details
                  h4.card__sub-heading= `Tur de ${tour.duration} zile - ${tour.difficulty}`
                  p.card__text= tour.summary

                  .card__data
                    svg.card__icon
                      use(xlink:href='img/icons.svg#icon-map-pin')
                    span= tour.startLocation.description

                  - const startDate = new Date(tour.startDates[0])
                  - const formattedDate = startDate.toLocaleDateString('ro-RO', { month: 'long', year: 'numeric' })
                  - const capitalizedDate = formattedDate.charAt(0).toUpperCase() + formattedDate.slice(1)

                  .card__data
                    svg.card__icon
                      use(xlink:href='img/icons.svg#icon-calendar')
                    span= capitalizedDate

                  .card__data
                    svg.card__icon
                      use(xlink:href='img/icons.svg#icon-flag')
                    span= `${tour.locations.length} opriri`

                  .card__data
                    svg.card__icon
                      use(xlink:href='img/icons.svg#icon-user')
                    span= `${tour.maxGroupSize} persoane`

                .card__footer
                  p
                    span.card__footer-value= `${tour.price} RON`

                  .btn-group-review
                    a.btn.btn--green.btn--small(href=`/tour/${tour.slug}`) Detalii
                    a.btn.btn--green.btn--small(href=`/tour/${tour.slug}/review`) Recenzie
